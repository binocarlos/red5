
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>TrackTube</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.0.2/css/bootstrap.min.css" rel="stylesheet">
        <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
  </head>

  <body>



    <div class="navbar navbar-inverse navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container">
          <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="brand" href="/">Track Tube</a>
          <div class="nav-collapse collapse">
            <ul class="nav">
              <!--<li class="active"><a href="/">Home</a></li>-->
              <li><a href="/">GPS Test</a></li>
              
             </ul>   
          </div>
        </div>
      </div>
    </div>
              









    <div class="container">

      <div class="row">
        <div class="span4">
          Accelerometer<br /><br />
          X: <span id="AX"></span><br />
          Y: <span id="AY"></span><br />
          Z: <span id="AZ"></span><br />

          Speed Knots: <span id="speed"></span><br />
          Lat: <span id="lat"></span><br />
          Lon: <span id="lon"></span><br />

        </div>
        <div class="span8">
          <div id="map-canvas" style="width: 400px; height: 400px"></div>
        </div>
      </div>

      <!--<hr>-->

    </div> <!-- /container -->

    <div id="floatingcar">
      <table width="100%" height="100%" border=0 cellpadding=0 cellspacing=0>
        <tr>
          <td align=center valign=middle>
            <img src="littlecar.png" width=25 />
          </td>
        </tr>
      </table>
    </div>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDY4b52pneoYK-22-1bF0d-ZB0zYFrncCw&sensor=false">
    </script>

    <script src="/socket.io/socket.io.js"></script>

    <script>

    $(function(){

      function layout(){
        var offset = $('#map-canvas').offset();
        $('#floatingcar').css({
          'position':'absolute',
          'left':offset.left + 'px',
          'top':offset.top + 'px'
        }).width($('#map-canvas').width()).height($('#map-canvas').height());
      }
      $(window).on('resize', function(){
        layout();
      })

      layout();

       var map;
    
   
        var mapOptions = {
          center: new google.maps.LatLng(-34.397, 150.644),
          zoom: 15,
          mapTypeId: google.maps.MapTypeId.HYBRID
        };

        map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
    
        
      function updatemap(lat, lon){
          var geolocate = new google.maps.LatLng(lat, lon);
            
            /*
            var infowindow = new google.maps.InfoWindow({
                map: map,
                position: geolocate,
                content:
                    '<h1>Location pinned from HTML5 Geolocation!</h1>' +
                    '<h2>Latitude: ' + position.coords.latitude + '</h2>' +
                    '<h2>Longitude: ' + position.coords.longitude + '</h2>'
            });
            */
            
            map.setCenter(geolocate);
      }
    
      var socket = io.connect();


      socket.on('packet', function (packet) {

        console.dir(packet);
        if(packet.type=='gps'){

          $('#speed').html(packet.packet.speedKnots);
          $('#lat').html(packet.packet.lat);
          $('#lon').html(packet.packet.lon);
          
          updatemap(packet.packet.lat, packet.packet.lon);
        }
        else{
          $('#AX').html(packet.packet.x);
          $('#AY').html(packet.packet.y);
          $('#AZ').html(packet.packet.z);
        }
      })



    })

    </script>

  </body>
</html>




